SET QUOTED_IDENTIFIER, ANSI_NULLS ON
GO
CREATE PROCEDURE [dbo].[опер_н]
(
	@ном_код int,
	@дата_зае datetime,
	@кли_код int,
	@счет_код int,

	@дата_вые datetime,

	@дата_вые_факт datetime,
    @сут               numeric(4,1),
	  @сут_дни         int,
	@пол_сут_зае bit ,
    @пол_сут_вые bit ,
	
	@кол_взр int,
	@кол_дет int,
	@рег int,
	
	@тип_зае_код int,
	@цель_код int,
	@ски_код int,
	@ски_про int,
	@цена bigint,
	@цена_изм bit,
	@инф_зае text,
	@инф_вые text,
	@раб_место char(30),
	@раб_должность char(30),
	@раб_ком_уд char(30),
	@раб_прибыл char(30),

	@виза_вид_код int,
	@виза_сер char(3),
	@виза_номер char(30),
	@виза_дата_с date,
	@виза_дата_по date,
	@страх_кем_код int,
	@страх_номер char(30),
	@страх_дата_с date,
	@страх_дата_по date,
	@миг_карта char(30),
	@миг_карта_дата_с date,
	@миг_карта_дата_по date,
	@гра_дата date,
	@гра_код int,
	@дата_соз datetime,
	@дата_изм datetime
)
AS
	SET NOCOUNT OFF;
INSERT INTO [опер]
            ([ном_код],
             [дата_зае],
             [кли_код],
             [счет_код],
      
             [дата_вые],
 
             [дата_вые_факт],
             [сут],
             [сут_дни],
  пол_сут_зае ,
  пол_сут_вые ,    
             [кол_взр],
             [кол_дет],
            [рег],
             [тип_зае_код],
             [цель_код],
            [ски_код],
	   [ски_про],
	   [цена],
         [цена_изм],      
             [инф_зае],
             [инф_вые],
             [раб_место],
             [раб_должность],
             [раб_ком_уд],
             [раб_прибыл],
          
             [виза_вид_код],
             [виза_сер],
             [виза_номер],
             [виза_дата_с],
             [виза_дата_по],
             [страх_кем_код],
             [страх_номер],
             [страх_дата_с],
             [страх_дата_по],
             [миг_карта],
             [миг_карта_дата_с],
             [миг_карта_дата_по],
             [гра_дата],
             [гра_код],
             [дата_соз],
             [дата_изм])
VALUES      (@ном_код,
             @дата_зае,
             @кли_код,
             @счет_код,
           
             @дата_вые,
        
             @дата_вые_факт,
             @сут,
           @сут_дни,
  @пол_сут_зае ,
  @пол_сут_вые ,  
             
             @кол_взр,
             @кол_дет,
             @рег,
             @тип_зае_код,
             @цель_код,
             @ски_код,
             @ски_про,
            @цена,
            @цена_изм,
             @инф_зае,
             @инф_вые,
             @раб_место,
             @раб_должность,
             @раб_ком_уд,
             @раб_прибыл,
        
             @виза_вид_код,
             @виза_сер,
             @виза_номер,
             @виза_дата_с,
             @виза_дата_по,
             @страх_кем_код,
             @страх_номер,
             @страх_дата_с,
             @страх_дата_по,
             @миг_карта,
             @миг_карта_дата_с,
             @миг_карта_дата_по,
             @гра_дата,
             @гра_код,
             @дата_соз,
             @дата_изм);

SELECT опер_код,
       ном_код,
       дата_зае,
       кли_код,
       счет_код,

       дата_вые,

       дата_вые_факт,
       сут,
      
     isnull(пол_сут_зае,0) as пол_сут_зае,
  isnull(пол_сут_вые,0) as пол_сут_вые, 
  isnull(сут_дни,0)  as сут_дни, 
      
       кол_взр,
       кол_дет,
      рег,
       тип_зае_код,
       цель_код,
       ски_код,
       ски_про,
      цена,
      цена_изм,
      
       инф_зае,
       инф_вые,
       раб_место,
       раб_должность,
       раб_ком_уд,
       раб_прибыл,
    
       виза_вид_код,
       виза_сер,
       виза_номер,
       виза_дата_с,
       виза_дата_по,
       страх_кем_код,
       страх_номер,
       страх_дата_с,
       страх_дата_по,
       миг_карта,
       миг_карта_дата_с,
       миг_карта_дата_по,
       гра_дата,
       гра_код,
       дата_соз,
       дата_изм
FROM   опер
WHERE  ( опер_код = Scope_identity() )
GO